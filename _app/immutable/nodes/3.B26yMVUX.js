import{t as k,a as P}from"../chunks/BTEwTIS6.js";import{p as U,b as X,o as Y,u as $,f as E,a as G,s as H,g as o,d,e as f}from"../chunks/ByGFX7SO.js";import{b as F}from"../chunks/wOx6kZMl.js";import{m as W}from"../chunks/CWzhDz5V.js";/* empty css                */var q=k('<div class="w-hull h-full"></div> <div class="pointer-events-none absolute left-0 top-0 z-10 h-12 w-12 bg-red-400"></div>',1);function N(w,M){U(M,!0);let i=X({contents:[139.477,35.681],triangle:[139.7454,35.6586]}),e=null,l=d(null),s=d(null),c=null,g=null,p=d(!1);const y=t=>({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:t.contents},properties:{type:"contents"}},{type:"Feature",geometry:{type:"Point",coordinates:t.triangle},properties:{type:"triangle"}}]}),x=(t,n)=>{var b,C;if(!o(p))return;const r=t.lngLat,a=e==null?void 0:e.project(r);if(!a||!o(l))return;console.log("Drag moved",a);const u=a.x,m=a.y,z=((b=o(s))==null?void 0:b.clientWidth)||0,S=((C=o(s))==null?void 0:C.clientHeight)||0,D=u-z/2,L=m-S/2;o(s).style.transform=`translate(${D}px, ${L}px)`,o(s).style.transition="none",n==="contents"?i.contents=[r.lng,r.lat]:n==="triangle"&&(i.triangle=[r.lng,r.lat])},j=()=>{if(!e)return;const t=e.getCanvasContainer();t.style.cursor="",f(p,!1),c&&(e.off("mousemove",c),c=null),g=null};Y(()=>{if(!o(l)){console.error("Map container is not defined");return}e=new W.Map({container:o(l),style:{version:8,glyphs:"https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf",sources:{pales:{type:"raster",tiles:["https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png"],tileSize:256,maxzoom:18,attribution:"<a href='https://www.gsi.go.jp/' target='_blank'>国土地理院</a>"}},layers:[{id:"pales_layer",source:"pales",type:"raster"}]},center:i.contents,zoom:9}),e.on("load",()=>{e&&(e.getSource("point")&&e.removeSource("point"),e.addSource("point",{type:"geojson",data:y(i)}),e.addLayer({id:"point",source:"point",type:"circle",paint:{"circle-radius":10,"circle-color":"#FF0000","circle-opacity":.8,"circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}),e.on("mouseenter","point",()=>{e&&(o(p)||(e.getCanvasContainer().style.cursor="pointer"))}),e.on("mouseleave","point",()=>{e&&(o(p)||(e.getCanvasContainer().style.cursor=""))}))}),e.on("mousedown","point",t=>{var u;t.preventDefault();const n=t.features&&t.features.length>0?t.features[0]:null,r=(u=n==null?void 0:n.properties)==null?void 0:u.type;if(!r||!e)return;f(p,!0);const a=e.getCanvasContainer();a.style.cursor="grabbing",c=m=>x(m,r),g=j,e.on("mousemove",c),e.once("mouseup",g)})}),$(()=>{const t=y(i);if(!e)return;const n=e.getSource("point");n&&n.setData(t)});var v=q(),h=E(v);F(h,t=>f(l,t),()=>o(l));var _=H(h,2);F(_,t=>f(s,t),()=>o(s)),P(w,v),G()}export{N as component};
